<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Dott. Emanuel Savianu | App</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dott. Savianu">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="apple-touch-icon" href="https://i.postimg.cc/R6LJHmdT/logo-transparent.png">
    <link rel="icon" type="image/png" href="https://i.postimg.cc/R6LJHmdT/logo-transparent.png">

    <link rel="manifest" href="data:application/manifest+json;charset=utf-8,%7B%22name%22%3A%22Dott.%20Emanuel%20Savianu%22%2C%22short_name%22%3A%22Dr.%20Savianu%22%2C%22description%22%3A%22Studio%20Medico%22%2C%22start_url%22%3A%22.%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23f8fafc%22%2C%22theme_color%22%3A%22%23ffffff%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22https%3A%2F%2Fi.postimg.cc%2FR6LJHmdT%2Flogo-transparent.png%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fpng%22%7D%2C%7B%22src%22%3A%22https%3A%2F%2Fi.postimg.cc%2FR6LJHmdT%2Flogo-transparent.png%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fpng%22%7D%5D%7D">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8',
                        }
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'glow': '0 0 15px rgba(37, 99, 235, 0.2)',
                    }
                }
            }
        }
    </script>

    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>

    <style>
        /* Base Styles */
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }

        /* Safe Area Utilities */
        .pb-safe { padding-bottom: env(safe-area-inset-bottom, 20px); }
        .pt-safe { padding-top: env(safe-area-inset-top, 20px); }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Animations */
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .animate-enter { animation: fadeInScale 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        /* Interactive feedback */
        .active-scale:active { transform: scale(0.96); transition: transform 0.1s; }
        
        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="text-slate-800 h-[100dvh] w-screen overflow-hidden select-none">
    
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo, memo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Home, Calendar, Phone, Info, Globe, ChevronRight, 
            MapPin, Clock, AlertTriangle, FileText, ExternalLink,
            ShieldCheck, Stethoscope, Mail, Copy
        } from 'lucide-react';

        // --- DATA & CONFIG ---
        const DATA = {
            it: {
                role: "Medico di Medicina Generale",
                welcome: "Benvenuto,",
                tab_home: "Home",
                tab_book: "Prenota",
                tab_contact: "Contatti",
                tab_info: "Info",
                
                // Home Cards
                card_millebook_title: "MilleBook",
                card_millebook_desc: "Ricette, Appuntamenti e Fascicolo",
                btn_access: "Accedi",
                
                card_emergency_title: "Emergenza?",
                card_emergency_desc: "Per urgenze mediche gravi chiama il 112",
                btn_call_112: "Chiama 112",
                
                section_services: "Servizi Rapidi",
                srv_new_patient: "Nuovi Pazienti",
                srv_drugs: "Modulo Farmaci",
                srv_guard: "Guardia Medica",

                // Booking
                book_title: "Prenotazioni",
                book_sub: "Scegli il metodo preferito",
                alert_millebook: "Si prega di utilizzare esclusivamente MilleBook per la gestione ordinaria.",
                btn_book_visit: "Prenota Visita",
                
                // Info
                hours_title: "Orari Studio",
                status_open: "Aperto ora",
                status_closed: "Chiuso",
                
                // Contacts
                contact_title: "Contattami",
                address: "Via Example 123, Città", // Placeholder
                privacy_policy: "Privacy Policy"
            },
            en: {
                role: "General Practitioner",
                welcome: "Welcome,",
                tab_home: "Home",
                tab_book: "Book",
                tab_contact: "Contact",
                tab_info: "Info",
                
                card_millebook_title: "MilleBook",
                card_millebook_desc: "Prescriptions & Appointments",
                btn_access: "Login",
                
                card_emergency_title: "Emergency?",
                card_emergency_desc: "For medical emergencies call 112",
                btn_call_112: "Call 112",
                
                section_services: "Quick Services",
                srv_new_patient: "New Patients",
                srv_drugs: "Drug Form",
                srv_guard: "Out-of-hours",

                book_title: "Booking",
                book_sub: "Choose your method",
                alert_millebook: "Please use MilleBook for all routine requests.",
                btn_book_visit: "Book Visit",
                
                hours_title: "Opening Hours",
                status_open: "Open now",
                status_closed: "Closed",
                
                contact_title: "Contact Me",
                address: "Via Example 123, City",
                privacy_policy: "Privacy Policy"
            }
        };

        const HOURS = [
            { day: "Lun", time: "17:00 – 18:30" },
            { day: "Mar", time: "11:30 – 13:00" },
            { day: "Mer", time: "17:00 – 18:30" },
            { day: "Gio", time: "11:30 – 13:00" },
            { day: "Ven", time: "17:00 – 18:30" },
            { day: "Sab", time: "Chiuso", closed: true },
            { day: "Dom", time: "Chiuso", closed: true },
        ];

        // --- COMPONENTS ---

        const Card = ({ children, className = "", onClick }) => (
            <div 
                onClick={onClick}
                className={`bg-white p-5 rounded-2xl shadow-soft border border-slate-100 ${onClick ? 'active-scale cursor-pointer' : ''} ${className}`}
            >
                {children}
            </div>
        );

        const Badge = ({ children, color = "blue" }) => {
            const colors = {
                blue: "bg-blue-50 text-blue-700 border-blue-100",
                red: "bg-red-50 text-red-700 border-red-100",
                green: "bg-emerald-50 text-emerald-700 border-emerald-100",
            };
            return (
                <span className={`px-2.5 py-1 rounded-lg text-xs font-semibold border ${colors[color]}`}>
                    {children}
                </span>
            );
        };

        const Header = memo(({ lang, toggleLang, t }) => (
            <header className="fixed top-0 w-full z-40 glass pt-safe px-6 pb-4">
                <div className="flex justify-between items-center h-14">
                    <div className="flex flex-col">
                        <span className="text-xs font-semibold text-slate-400 uppercase tracking-wider">{t.role}</span>
                        <h1 className="text-xl font-bold text-slate-900 leading-tight">Dott. Savianu</h1>
                    </div>
                    <button 
                        onClick={toggleLang}
                        className="flex items-center gap-1.5 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-full text-xs font-bold text-slate-600 transition-colors active-scale"
                    >
                        <Globe size={14} />
                        {lang.toUpperCase()}
                    </button>
                </div>
            </header>
        ));

        // --- VIEWS ---

        const HomeView = ({ t }) => (
            <div className="space-y-6 pt-4 pb-24 px-6 animate-enter">
                
                {/* MilleBook Hero Card */}
                <Card className="bg-gradient-to-br from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/30 border-none relative overflow-hidden" onClick={() => window.open('https://millebook.it', '_blank')}>
                    <div className="absolute top-0 right-0 p-4 opacity-10">
                        <FileText size={100} />
                    </div>
                    <div className="relative z-10">
                        <div className="flex items-center gap-2 mb-2">
                            <ShieldCheck size={20} className="text-blue-200" />
                            <span className="text-xs font-bold uppercase tracking-widest text-blue-100">Pazienti Registrati</span>
                        </div>
                        <h2 className="text-2xl font-bold mb-1">{t.card_millebook_title}</h2>
                        <p className="text-blue-100 text-sm mb-4">{t.card_millebook_desc}</p>
                        <div className="inline-flex items-center bg-white/20 backdrop-blur-sm px-4 py-2 rounded-lg text-sm font-semibold">
                            {t.btn_access} <ExternalLink size={14} className="ml-2" />
                        </div>
                    </div>
                </Card>

                {/* Quick Actions Grid */}
                <div>
                    <h3 className="text-sm font-bold text-slate-400 mb-3 uppercase tracking-wider">{t.section_services}</h3>
                    <div className="grid grid-cols-2 gap-3">
                        <Card onClick={() => window.open('https://miodottore.it', '_blank')} className="flex flex-col items-center justify-center text-center py-6 gap-2">
                            <div className="p-3 bg-emerald-50 text-emerald-600 rounded-full mb-1">
                                <Stethoscope size={24} />
                            </div>
                            <span className="font-semibold text-sm">{t.srv_new_patient}</span>
                        </Card>

                        <Card className="flex flex-col items-center justify-center text-center py-6 gap-2" onClick={() => alert('Funzione modulo farmaci')}>
                            <div className="p-3 bg-purple-50 text-purple-600 rounded-full mb-1">
                                <FileText size={24} />
                            </div>
                            <span className="font-semibold text-sm">{t.srv_drugs}</span>
                        </Card>
                    </div>
                </div>

                {/* Emergency Card */}
                <Card className="border-red-100 bg-red-50/50" onClick={() => window.location.href = 'tel:112'}>
                    <div className="flex items-start gap-4">
                        <div className="p-3 bg-red-100 text-red-600 rounded-xl shrink-0">
                            <AlertTriangle size={24} />
                        </div>
                        <div>
                            <h3 className="font-bold text-red-900">{t.card_emergency_title}</h3>
                            <p className="text-sm text-red-700/80 mb-2">{t.card_emergency_desc}</p>
                            <span className="text-xs font-bold text-red-600 underline">{t.btn_call_112}</span>
                        </div>
                    </div>
                </Card>
            </div>
        );

        const BookingView = ({ t }) => (
            <div className="space-y-6 pt-4 pb-24 px-6 animate-enter">
                <div className="bg-amber-50 border border-amber-100 rounded-2xl p-4 flex gap-3">
                    <Info className="text-amber-600 shrink-0" size={20} />
                    <p className="text-xs text-amber-800 leading-relaxed font-medium">
                        {t.alert_millebook}
                    </p>
                </div>

                <div className="space-y-3">
                    <Card onClick={() => window.open('https://millebook.it', '_blank')} className="flex items-center justify-between group">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-lg">M</div>
                            <div>
                                <h3 className="font-bold text-slate-900">MilleBook</h3>
                                <p className="text-xs text-slate-500">Appuntamenti & Ricette</p>
                            </div>
                        </div>
                        <ChevronRight className="text-slate-300 group-active:text-blue-500" />
                    </Card>

                    <Card onClick={() => window.open('https://miodottore.it', '_blank')} className="flex items-center justify-between group">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center">
                                <Calendar size={20} />
                            </div>
                            <div>
                                <h3 className="font-bold text-slate-900">{t.btn_book_visit}</h3>
                                <p className="text-xs text-slate-500">MioDottore / Nuovi Pazienti</p>
                            </div>
                        </div>
                        <ChevronRight className="text-slate-300 group-active:text-emerald-500" />
                    </Card>
                </div>
            </div>
        );

        const InfoView = ({ t }) => {
            const today = new Date().getDay(); // 0 is Sunday, 1 is Monday
            // Adjust JS day (0-6 Sun-Sat) to Array index (0=Mon, 6=Sun in HOURS array)
            const todayIndex = today === 0 ? 6 : today - 1;

            return (
                <div className="space-y-6 pt-4 pb-24 px-6 animate-enter">
                    <Card>
                        <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                            <Clock size={20} className="text-blue-600" />
                            {t.hours_title}
                        </h3>
                        <div className="space-y-3">
                            {HOURS.map((h, i) => (
                                <div key={i} className={`flex justify-between items-center text-sm p-2 rounded-lg ${i === todayIndex ? 'bg-blue-50 font-semibold' : ''}`}>
                                    <span className={i === todayIndex ? 'text-blue-700' : 'text-slate-600'}>{h.day}</span>
                                    {h.closed ? (
                                        <Badge color="red">{t.status_closed}</Badge>
                                    ) : (
                                        <span className={i === todayIndex ? 'text-blue-900' : 'text-slate-900'}>{h.time}</span>
                                    )}
                                </div>
                            ))}
                        </div>
                    </Card>

                    <Card className="bg-slate-800 text-white">
                        <div className="flex gap-4">
                            <div className="p-2 bg-white/10 rounded-lg h-fit">
                                <AlertTriangle size={20} className="text-yellow-400" />
                            </div>
                            <div>
                                <h4 className="font-bold text-yellow-400 mb-1">{t.srv_guard}</h4>
                                <p className="text-xs text-slate-300 leading-relaxed">
                                    Servizio attivo tutte le notti (20:00 - 08:00) e nei giorni festivi e prefestivi.
                                    <br/>Tel: <strong>116117</strong>
                                </p>
                            </div>
                        </div>
                    </Card>
                </div>
            );
        };

        const ContactView = ({ t }) => (
            <div className="space-y-6 pt-4 pb-24 px-6 animate-enter">
                <Card>
                    <h3 className="font-bold text-lg mb-4">{t.contact_title}</h3>
                    <div className="space-y-4">
                        <div className="flex items-start gap-4 p-3 bg-slate-50 rounded-xl active-scale cursor-pointer" onClick={() => window.open('https://maps.google.com')}>
                            <MapPin className="text-blue-600 mt-1" size={20} />
                            <div>
                                <p className="font-semibold text-slate-900">Studio Medico</p>
                                <p className="text-sm text-slate-500">{t.address}</p>
                                <p className="text-xs text-blue-600 mt-1 font-medium">Apri Maps</p>
                            </div>
                        </div>
                        
                        <div className="flex items-center gap-4 p-3 bg-slate-50 rounded-xl active-scale cursor-pointer" onClick={() => window.location.href = "mailto:info@dr-savianu.it"}>
                            <Mail className="text-blue-600" size={20} />
                            <div>
                                <p className="font-semibold text-slate-900">Email</p>
                                <p className="text-sm text-slate-500">info@dr-savianu.it</p>
                            </div>
                        </div>
                    </div>
                </Card>

                <div className="text-center">
                     <p className="text-xs text-slate-400 mb-2">P.IVA: 00000000000</p>
                     <button className="text-xs text-slate-400 underline">{t.privacy_policy}</button>
                </div>
            </div>
        );

        // --- MAIN APP ---

        const App = () => {
            const [lang, setLang] = useState('it');
            const [activeTab, setActiveTab] = useState('home');
            
            const t = useMemo(() => DATA[lang], [lang]);

            const tabs = [
                { id: 'home', icon: Home, label: t.tab_home },
                { id: 'book', icon: Calendar, label: t.tab_book },
                { id: 'contact', icon: MapPin, label: t.tab_contact },
                { id: 'info', icon: Info, label: t.tab_info },
            ];

            const toggleLang = useCallback(() => {
                setLang(prev => prev === 'it' ? 'en' : 'it');
            }, []);

            return (
                <div className="flex flex-col h-full bg-slate-50">
                    <Header lang={lang} toggleLang={toggleLang} t={t} />

                    <main className="flex-1 overflow-y-auto no-scrollbar mt-[80px]">
                        {activeTab === 'home' && <HomeView t={t} />}
                        {activeTab === 'book' && <BookingView t={t} />}
                        {activeTab === 'contact' && <ContactView t={t} />}
                        {activeTab === 'info' && <InfoView t={t} />}
                    </main>

                    {/* Navigation Bar */}
                    <nav className="fixed bottom-0 w-full bg-white border-t border-slate-100 pb-safe shadow-[0_-5px_20px_rgba(0,0,0,0.03)] z-50">
                        <div className="flex justify-around items-center px-2 py-3">
                            {tabs.map((tab) => {
                                const isActive = activeTab === tab.id;
                                const Icon = tab.icon;
                                return (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`flex flex-col items-center justify-center w-16 transition-all duration-300 active-scale`}
                                    >
                                        <div className={`p-1.5 rounded-xl mb-1 transition-all ${isActive ? 'bg-blue-50 text-blue-600 translate-y-[-2px]' : 'text-slate-400'}`}>
                                            <Icon size={24} strokeWidth={isActive ? 2.5 : 2} />
                                        </div>
                                        <span className={`text-[10px] font-medium transition-opacity ${isActive ? 'text-blue-600 opacity-100' : 'text-slate-400 opacity-0 hidden'}`}>
                                            {tab.label}
                                        </span>
                                    </button>
                                )
                            })}
                        </div>
                    </nav>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('data:text/javascript;base64,Ly8gU2ltcGxlIFBXQSBXb3JrZXIKY29uc3QgQ0FDSEUgPSAndjEnOwpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2luc3RhbGwnLCBlID0+IGUud2FpdFVudGlsKGNhY2hlcy5vcGVuKENBQ0hFKS50aGVuKGMgPT4gYy5hZGRBbGwoWycuLyddKSkpKTsKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdZZXRjaCcsIGUgPT4gZS5yZXNwb25kV2l0aChjYWNoZXMubWF0Y2goZS5yZXF1ZXN0KS50aGVuKHIgPT4gciB8fCBmZXRjaChlLnJlcXVlc3QpKSkpOw==')
                .then(() => console.log('SW Registered'));
            });
        }
    </script>
</body>
</html>
