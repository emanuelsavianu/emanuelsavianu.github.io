<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Dott. Emanuel Savianu | App</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dott. Savianu">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        primary: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' }
                    },
                    boxShadow: {
                        'soft': '0 10px 40px -10px rgba(0,0,0,0.08)',
                    }
                }
            }
        }
    </script>

    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>

    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom, 20px); }
        .pt-safe { padding-top: env(safe-area-inset-top, 20px); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-enter { animation: fadeIn 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        .active-scale:active { transform: scale(0.97); }
    </style>
</head>
<body class="text-slate-800 h-[100dvh] w-screen overflow-hidden select-none">
    
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useMemo, memo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Home, Calendar, Info, Globe, ChevronRight, 
            MapPin, Clock, AlertTriangle, FileText, ExternalLink,
            ShieldCheck, Stethoscope, Mail
        } from 'lucide-react';

        // --- CUSTOM LOGO COMPONENT (Fixed: No external images) ---
        const AppLogo = ({ size = 40, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" className={className}>
                <rect width="40" height="40" rx="12" fill="#2563EB"/>
                <path d="M20 10V30" stroke="white" strokeWidth="3" strokeLinecap="round"/>
                <path d="M10 20H30" stroke="white" strokeWidth="3" strokeLinecap="round"/>
            </svg>
        );

        // --- DATA ---
        const DATA = {
            it: {
                role: "Medico di Medicina Generale",
                tab_home: "Home",
                tab_book: "Prenota",
                tab_contact: "Contatti",
                tab_info: "Info",
                card_millebook_title: "MilleBook",
                card_millebook_desc: "Ricette, Appuntamenti e Fascicolo",
                btn_access: "Accedi",
                card_emergency_title: "Emergenza?",
                card_emergency_desc: "Per urgenze gravi chiama il 112",
                btn_call_112: "Chiama 112",
                section_services: "Servizi Rapidi",
                srv_new_patient: "Nuovi Pazienti",
                srv_drugs: "Modulo Farmaci",
                book_sub: "Scegli il metodo preferito",
                alert_millebook: "Si prega di utilizzare esclusivamente MilleBook per la gestione ordinaria.",
                btn_book_visit: "Prenota Visita",
                hours_title: "Orari Studio",
                status_closed: "Chiuso",
                contact_title: "Contattami",
                address: "Via Example 123, Città",
                privacy: "Privacy Policy"
            },
            en: {
                role: "General Practitioner",
                tab_home: "Home",
                tab_book: "Book",
                tab_contact: "Contact",
                tab_info: "Info",
                card_millebook_title: "MilleBook",
                card_millebook_desc: "Prescriptions & Appointments",
                btn_access: "Login",
                card_emergency_title: "Emergency?",
                card_emergency_desc: "For medical emergencies call 112",
                btn_call_112: "Call 112",
                section_services: "Quick Services",
                srv_new_patient: "New Patients",
                srv_drugs: "Drug Form",
                book_sub: "Choose your method",
                alert_millebook: "Please use MilleBook for all routine requests.",
                btn_book_visit: "Book Visit",
                hours_title: "Opening Hours",
                status_closed: "Closed",
                contact_title: "Contact Me",
                address: "Via Example 123, City",
                privacy: "Privacy Policy"
            }
        };

        const HOURS = [
            { day: "Lun", time: "17:00 – 18:30" },
            { day: "Mar", time: "11:30 – 13:00" },
            { day: "Mer", time: "17:00 – 18:30" },
            { day: "Gio", time: "11:30 – 13:00" },
            { day: "Ven", time: "17:00 – 18:30" },
            { day: "Sab", time: "Chiuso", closed: true },
            { day: "Dom", time: "Chiuso", closed: true },
        ];

        // --- COMPONENTS ---
        const Card = ({ children, className = "", onClick }) => (
            <div onClick={onClick} className={`bg-white p-5 rounded-2xl shadow-soft border border-slate-100 ${onClick ? 'active-scale cursor-pointer' : ''} ${className}`}>
                {children}
            </div>
        );

        const Header = memo(({ lang, toggleLang, t }) => (
            <header className="fixed top-0 w-full z-40 glass pt-safe px-6 pb-3">
                <div className="flex justify-between items-center h-16">
                    <div className="flex items-center gap-3">
                        <AppLogo size={38} className="shadow-lg shadow-blue-500/20" />
                        <div className="flex flex-col">
                            <h1 className="text-lg font-bold text-slate-900 leading-none">Dott. Savianu</h1>
                            <span className="text-[11px] font-semibold text-slate-400 uppercase tracking-wide mt-1">{t.role}</span>
                        </div>
                    </div>
                    <button onClick={toggleLang} className="bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-full text-xs font-bold text-slate-600 transition-colors active-scale flex items-center gap-1">
                        <Globe size={13} /> {lang.toUpperCase()}
                    </button>
                </div>
            </header>
        ));

        // --- VIEWS ---
        const HomeView = ({ t }) => (
            <div className="space-y-6 pt-6 pb-28 px-6 animate-enter">
                <Card className="bg-gradient-to-br from-blue-600 to-blue-700 text-white shadow-xl shadow-blue-500/30 border-none relative overflow-hidden" onClick={() => window.open('https://millebook.it', '_blank')}>
                    <div className="absolute -right-4 -top-4 opacity-10 rotate-12">
                        <FileText size={120} />
                    </div>
                    <div className="relative z-10">
                        <div className="flex items-center gap-2 mb-3">
                            <span className="bg-white/20 backdrop-blur-md px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider">Area Pazienti</span>
                        </div>
                        <h2 className="text-2xl font-bold mb-1">{t.card_millebook_title}</h2>
                        <p className="text-blue-100 text-sm mb-5 opacity-90">{t.card_millebook_desc}</p>
                        <div className="inline-flex items-center bg-white text-blue-700 px-5 py-2.5 rounded-xl text-sm font-bold shadow-lg">
                            {t.btn_access} <ExternalLink size={14} className="ml-2" />
                        </div>
                    </div>
                </Card>

                <div>
                    <h3 className="text-xs font-bold text-slate-400 mb-3 uppercase tracking-wider ml-1">{t.section_services}</h3>
                    <div className="grid grid-cols-2 gap-3">
                        <Card onClick={() => window.open('https://miodottore.it', '_blank')} className="flex flex-col items-center justify-center text-center py-5 gap-2 hover:border-emerald-200 transition-colors">
                            <div className="w-10 h-10 bg-emerald-50 text-emerald-600 rounded-full flex items-center justify-center mb-1">
                                <Stethoscope size={20} />
                            </div>
                            <span className="font-semibold text-sm leading-tight">{t.srv_new_patient}</span>
                        </Card>

                        <Card className="flex flex-col items-center justify-center text-center py-5 gap-2 hover:border-purple-200 transition-colors" onClick={() => alert('Funzione modulo farmaci')}>
                            <div className="w-10 h-10 bg-purple-50 text-purple-600 rounded-full flex items-center justify-center mb-1">
                                <FileText size={20} />
                            </div>
                            <span className="font-semibold text-sm leading-tight">{t.srv_drugs}</span>
                        </Card>
                    </div>
                </div>

                <Card className="border-red-100 bg-red-50/60" onClick={() => window.location.href = 'tel:112'}>
                    <div className="flex items-center gap-4">
                        <div className="w-10 h-10 bg-red-100 text-red-600 rounded-full flex items-center justify-center shrink-0">
                            <AlertTriangle size={20} />
                        </div>
                        <div className="flex-1">
                            <h3 className="font-bold text-red-900 text-sm">{t.card_emergency_title}</h3>
                            <p className="text-xs text-red-700/80">{t.card_emergency_desc}</p>
                        </div>
                        <ChevronRight className="text-red-300" size={20} />
                    </div>
                </Card>
            </div>
        );

        const BookingView = ({ t }) => (
            <div className="space-y-4 pt-6 pb-28 px-6 animate-enter">
                <div className="bg-amber-50 border border-amber-100 rounded-2xl p-4 flex gap-3">
                    <Info className="text-amber-600 shrink-0 mt-0.5" size={18} />
                    <p className="text-xs text-amber-800 leading-relaxed font-medium">{t.alert_millebook}</p>
                </div>
                <div className="space-y-3">
                    <Card onClick={() => window.open('https://millebook.it', '_blank')} className="flex items-center justify-between group">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-lg">M</div>
                            <div>
                                <h3 className="font-bold text-slate-900">MilleBook</h3>
                                <p className="text-xs text-slate-500">Appuntamenti & Ricette</p>
                            </div>
                        </div>
                        <ChevronRight className="text-slate-300" />
                    </Card>
                    <Card onClick={() => window.open('https://miodottore.it', '_blank')} className="flex items-center justify-between group">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center">
                                <Calendar size={20} />
                            </div>
                            <div>
                                <h3 className="font-bold text-slate-900">{t.btn_book_visit}</h3>
                                <p className="text-xs text-slate-500">MioDottore / Nuovi Pazienti</p>
                            </div>
                        </div>
                        <ChevronRight className="text-slate-300" />
                    </Card>
                </div>
            </div>
        );

        const InfoView = ({ t }) => {
            const todayIndex = new Date().getDay() === 0 ? 6 : new Date().getDay() - 1;
            return (
                <div className="space-y-6 pt-6 pb-28 px-6 animate-enter">
                    <Card>
                        <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                            <Clock size={20} className="text-blue-600" /> {t.hours_title}
                        </h3>
                        <div className="space-y-2">
                            {HOURS.map((h, i) => (
                                <div key={i} className={`flex justify-between items-center text-sm p-2 rounded-lg ${i === todayIndex ? 'bg-blue-50' : ''}`}>
                                    <span className={i === todayIndex ? 'text-blue-700 font-semibold' : 'text-slate-500'}>{h.day}</span>
                                    <span className={i === todayIndex ? 'text-blue-900 font-bold' : 'text-slate-900'}>{h.closed ? t.status_closed : h.time}</span>
                                </div>
                            ))}
                        </div>
                    </Card>
                </div>
            );
        };

        const ContactView = ({ t }) => (
            <div className="space-y-6 pt-6 pb-28 px-6 animate-enter">
                <Card>
                    <h3 className="font-bold text-lg mb-4">{t.contact_title}</h3>
                    <div className="space-y-4">
                        <div className="flex items-center gap-4 p-3 bg-slate-50 rounded-xl active-scale cursor-pointer">
                            <div className="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-blue-600"><MapPin size={20} /></div>
                            <div>
                                <p className="font-semibold text-slate-900">Studio Medico</p>
                                <p className="text-xs text-slate-500">{t.address}</p>
                            </div>
                        </div>
                        <div className="flex items-center gap-4 p-3 bg-slate-50 rounded-xl active-scale cursor-pointer" onClick={() => window.location.href = "mailto:info@example.com"}>
                            <div className="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-blue-600"><Mail size={20} /></div>
                            <div>
                                <p className="font-semibold text-slate-900">Email</p>
                                <p className="text-xs text-slate-500">info@dr-savianu.it</p>
                            </div>
                        </div>
                    </div>
                </Card>
                <div className="text-center pt-4">
                    <p className="text-[10px] text-slate-400">© 2024 Dr. Savianu • P.IVA 00000000000</p>
                </div>
            </div>
        );

        const App = () => {
            const [lang, setLang] = useState('it');
            const [activeTab, setActiveTab] = useState('home');
            const t = useMemo(() => DATA[lang], [lang]);

            return (
                <div className="flex flex-col h-full">
                    <Header lang={lang} toggleLang={() => setLang(l => l === 'it' ? 'en' : 'it')} t={t} />
                    
                    <main className="flex-1 overflow-y-auto no-scrollbar mt-[80px]">
                        {activeTab === 'home' && <HomeView t={t} />}
                        {activeTab === 'book' && <BookingView t={t} />}
                        {activeTab === 'contact' && <ContactView t={t} />}
                        {activeTab === 'info' && <InfoView t={t} />}
                    </main>

                    <nav className="fixed bottom-0 w-full bg-white border-t border-slate-100 pb-safe shadow-[0_-5px_20px_rgba(0,0,0,0.03)] z-50">
                        <div className="flex justify-around items-center px-2 py-3">
                            {[
                                { id: 'home', icon: Home, label: t.tab_home },
                                { id: 'book', icon: Calendar, label: t.tab_book },
                                { id: 'contact', icon: MapPin, label: t.tab_contact },
                                { id: 'info', icon: Info, label: t.tab_info }
                            ].map((tab) => {
                                const isActive = activeTab === tab.id;
                                const Icon = tab.icon;
                                return (
                                    <button key={tab.id} onClick={() => setActiveTab(tab.id)} className="flex flex-col items-center justify-center w-16 active-scale">
                                        <div className={`p-1.5 rounded-xl mb-1 transition-all duration-300 ${isActive ? 'bg-blue-50 text-blue-600 -translate-y-1' : 'text-slate-300'}`}>
                                            <Icon size={24} strokeWidth={isActive ? 2.5 : 2} />
                                        </div>
                                        <span className={`text-[10px] font-bold transition-all duration-300 ${isActive ? 'text-blue-600 opacity-100' : 'opacity-0 hidden'}`}>{tab.label}</span>
                                    </button>
                                )
                            })}
                        </div>
                    </nav>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
