<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Prospetto Ferie Studio Medico 2026</title>
    <style>
        /* Impostazioni di Stampa */
        @page {
            size: A4 landscape;
            margin: 10mm;
        }
        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page-break { page-break-after: always; }
            .no-print { display: none; }
        }

        /* Stile Generale */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 10px;
            color: #333;
        }

        h1, h2 {
            text-align: center;
            margin: 5px 0;
            text-transform: uppercase;
        }

        /* Legenda */
        .legend-container {
            border: 2px solid #333;
            padding: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            background-color: #f9f9f9;
        }
        .doctor-slot {
            margin: 5px 15px;
            font-size: 14px;
        }
        .color-box {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 1px solid #000;
            margin-right: 5px;
            vertical-align: middle;
            background: #fff;
        }

        /* Tabella Calendario */
        .month-container {
            margin-bottom: 30px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #444;
            text-align: center;
            padding: 0;
        }

        th {
            background-color: #eee;
            font-size: 11px;
            height: 25px;
        }

        col.col-label { width: 140px; }

        /* Righe */
        .row-ferie {
            height: 40px;
            background-color: #fff;
        }
        .row-sostituto {
            height: 25px;
            background-color: #fcfcfc;
        }
        
        .label-cell {
            font-weight: bold;
            font-size: 11px;
            padding: 2px 5px;
            text-align: left;
        }

        .label-sub {
            font-size: 9px;
            text-align: right;
            padding-right: 5px;
            font-style: italic;
            color: #555;
            line-height: 1;
        }
        
        .day-cell {
            border-right: 1px solid #444;
        }
        
        .invalid-day {
            background-color: #ddd;
            background-image: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 50%, #ccc 50%, #ccc 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }

        .note {
            font-size: 12px;
            font-style: italic;
            margin-top: 5px;
        }
    </style>
</head>
<body>

    <div class="no-print" style="background: #ffeb3b; padding: 10px; text-align: center; border: 1px solid #daa520; margin-bottom: 20px;">
        <strong>ANTEPRIMA:</strong> Per stampare, premi <code>CTRL + P</code>. Seleziona "Layout: Orizzontale".
    </div>

    <h1>Prospetto Ferie Studio Medico 2026</h1>
    <div class="legend-container">
        <div style="width: 100%; text-align: center; font-weight: bold; margin-bottom: 10px;">
            LEGENDA MEDICI (Scegliere un colore per medico)
        </div>
        <div class="doctor-slot"><span class="color-box"></span> Dott. __________________</div>
        <div class="doctor-slot"><span class="color-box"></span> Dott. __________________</div>
        <div class="doctor-slot"><span class="color-box"></span> Dott. __________________</div>
        <div class="doctor-slot"><span class="color-box"></span> Dott. __________________</div>
        <div class="doctor-slot"><span class="color-box"></span> Dott. __________________</div>
        <div class="doctor-slot"><span class="color-box"></span> Dott. __________________</div>
    </div>
    <p class="note"><strong>Regola:</strong> Max 2 medici assenti contemporaneamente. Indicare i sostituti (Mattina/Pomeriggio) nelle righe dedicate sotto ogni fascia ferie.</p>

    <div id="calendar-container"></div>

    <script>
        const container = document.getElementById('calendar-container');
        const year = 2026;
        const monthNames = ["", "GENNAIO", "FEBBRAIO", "MARZO", "APRILE", "MAGGIO", "GIUGNO", "LUGLIO", "AGOSTO", "SETTEMBRE", "OTTOBRE", "NOVEMBRE", "DICEMBRE"];
        
        for (let m = 2; m <= 12; m++) {
            let daysInMonth = new Date(year, m, 0).getDate();
            let monthDiv = document.createElement('div');
            monthDiv.className = 'month-container';
            if (m > 2) monthDiv.classList.add('page-break'); 

            let html = `<h2>${monthNames[m]} ${year}</h2>`;
            html += `<table>`;
            html += `<colgroup><col class="col-label">`;
            for(let i=1; i<=31; i++) html += `<col>`;
            html += `</colgroup>`;

            // Intestazione
            html += `<tr><th>DATA</th>`;
            for (let d = 1; d <= 31; d++) {
                html += (d <= daysInMonth) ? `<th>${d}</th>` : `<th class="invalid-day"></th>`;
            }
            html += `</tr>`;

            // Generazione Blocchi per Medico 1 e Medico 2
            for (let i = 1; i <= 2; i++) {
                // Riga Colore Ferie
                html += `<tr class="row-ferie"><td class="label-cell" style="background:#eee">ASSENZA (${i})<br><small>Colore Medico</small></td>`;
                for (let d = 1; d <= 31; d++) {
                    html += (d <= daysInMonth) ? `<td class="day-cell"></td>` : `<td class="invalid-day"></td>`;
                }
                html += `</tr>`;

                // Riga Sostituto Mattina
                html += `<tr class="row-sostituto"><td class="label-cell label-sub">Sost. Mattina &#8593;</td>`;
                for (let d = 1; d <= 31; d++) {
                    html += (d <= daysInMonth) ? `<td class="day-cell"></td>` : `<td class="invalid-day"></td>`;
                }
                html += `</tr>`;

                // Riga Sostituto Pomeriggio
                html += `<tr class="row-sostituto"><td class="label-cell label-sub">Sost. Pomeriggio &#8593;</td>`;
                for (let d = 1; d <= 31; d++) {
                    html += (d <= daysInMonth) ? `<td class="day-cell"></td>` : `<td class="invalid-day"></td>`;
                }
                html += `</tr>`;
            }

            html += `</table>`;
            monthDiv.innerHTML = html;
            container.appendChild(monthDiv);
        }
    </script>

</body>
</html>
