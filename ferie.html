<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Prospetto Ferie Studio Medico 2026 - 7 Medici</title>
    <style>
        @page { size: A4 landscape; margin: 7mm; }
        @media print { 
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page-break { page-break-after: always; }
            .no-print { display: none; }
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 5px; color: #222; font-size: 10px; }
        h1, h2 { text-align: center; margin: 2px 0; text-transform: uppercase; }
        h2 { color: #2c3e50; border-bottom: 2px solid #2c3e50; padding-bottom: 2px; margin-top: 8px; font-size: 16px; }
        
        .legend-container {
            border: 1px solid #444; padding: 5px; margin-bottom: 8px;
            display: flex; justify-content: space-around; flex-wrap: wrap; background-color: #f8f9fa;
        }
        .doctor-slot { margin: 2px 8px; font-weight: bold; font-size: 10px; }
        .color-box {
            display: inline-block; width: 14px; height: 14px; border: 1px solid #000;
            margin-right: 4px; vertical-align: middle; background: #fff;
        }

        table { width: 100%; border-collapse: collapse; table-layout: fixed; margin-top: 5px; }
        th, td { border: 1px solid #333; text-align: center; padding: 0; }
        th { background-color: #dfe6e9; height: 18px; font-size: 9px; }
        
        col.col-label { width: 155px; }

        /* Righe */
        .row-ferie { height: 28px; background-color: #fff; }
        .row-sost-m { height: 18px; background-color: #f1f9ff; } 
        .row-sost-p { height: 18px; background-color: #fff9f1; } 
        .row-amb { height: 20px; background-color: #fdf2ff; }   
        .row-tel { height: 18px; background-color: #ebfaeb; }   
        
        .label-cell { font-weight: bold; font-size: 8.5px; padding: 1px 4px; text-align: left; line-height: 1; }
        .label-sub { font-size: 8px; text-align: right; padding-right: 4px; font-style: italic; color: #444; }
        
        .invalid-day { background-color: #bdc3c7; opacity: 0.5; }
        .note-box { font-size: 9px; background: #eee; padding: 4px 10px; border-left: 4px solid #2c3e50; margin-bottom: 5px; }
    </style>
</head>
<body>

    <div class="no-print" style="background: #ffeb3b; padding: 5px; text-align: center; border: 1px solid #daa520; margin-bottom: 5px;">
        <strong>VERSIONE 7 MEDICI:</strong> Include Claudia e Giulia. Stampa in <b>Orizzontale</b>.
    </div>

    <h1>Gestione Sostituzioni 2026 - Gruppo Medico (7)</h1>
    
    <div class="legend-container">
        <div class="doctor-slot"><span class="color-box"></span> Carlo</div>
        <div class="doctor-slot"><span class="color-box"></span> Matteo</div>
        <div class="doctor-slot"><span class="color-box"></span> Emanuel</div>
        <div class="doctor-slot"><span class="color-box"></span> Renato</div>
        <div class="doctor-slot"><span class="color-box"></span> Mauro</div>
        <div class="doctor-slot"><span class="color-box"></span> Claudia</div>
        <div class="doctor-slot"><span class="color-box"></span> Giulia</div>
        <div class="doctor-slot" style="color: #666; font-style: italic;">(+ Olmo)</div>
    </div>

    <div class="note-box">
        <strong>Accordi:</strong> Sostituzione incrociata M/P ‚Ä¢ Lasciare 2 slot liberi/ambulatorio per assente ‚Ä¢ Segnare copertura esterna (Olmo/Renato/Mauro) ‚Ä¢ Tel. (8-10/11).
    </div>

    <div id="calendar-container"></div>

    <script>
        const container = document.getElementById('calendar-container');
        const year = 2026;
        const monthNames = ["", "GENNAIO", "FEBBRAIO", "MARZO", "APRILE", "MAGGIO", "GIUGNO", "LUGLIO", "AGOSTO", "SETTEMBRE", "OTTOBRE", "NOVEMBRE", "DICEMBRE"];
        
        for (let m = 2; m <= 12; m++) {
            let daysInMonth = new Date(year, m, 0).getDate();
            let monthDiv = document.createElement('div');
            monthDiv.className = 'month-container';
            if (m > 2) monthDiv.classList.add('page-break'); 

            let html = `<h2>${monthNames[m]} ${year}</h2>`;
            html += `<table><colgroup><col class="col-label">`;
            for(let i=1; i<=31; i++) html += `<col>`;
            html += `</colgroup><tr><th>DATA</th>`;
            for (let d = 1; d <= 31; d++) {
                html += (d <= daysInMonth) ? `<th>${d}</th>` : `<th class="invalid-day"></th>`;
            }
            html += `</tr>`;

            // Blocchi Assenze 1 e 2
            html += renderBlock(1, daysInMonth);
            html += renderBlock(2, daysInMonth);
            
            // Riga Copertura Ambulatorio
            html += `<tr class="row-amb"><td class="label-cell">üè• COPERTURA ESTERNA<br><small>(Olmo/Renato/Mauro)</small></td>`;
            for (let d = 1; d <= 31; d++) {
                html += (d <= daysInMonth) ? `<td></td>` : `<th class="invalid-day"></th>`;
            }
            html += `</tr>`;

            // Riga Telefono
            html += `<tr class="row-tel"><td class="label-cell">üìû REPERIBILIT√Ä TEL. <small>(8-11)</small></td>`;
            for (let d = 1; d <= 31; d++) {
                html += (d <= daysInMonth) ? `<td></td>` : `<th class="invalid-day"></th>`;
            }
            html += `</tr>`;

            html += `</table>`;
            monthDiv.innerHTML = html;
            container.appendChild(monthDiv);
        }

        function renderBlock(index, daysInMonth) {
            let block = `<tr class="row-ferie"><td class="label-cell" style="background:#f4f4f4">ASSENZA (${index}) <small>Colore</small></td>`;
            for (let d = 1; d <= 31; d++) block += (d <= daysInMonth) ? `<td></td>` : `<td class="invalid-day"></td>`;
            block += `</tr>`;
            
            block += `<tr class="row-sost-m"><td class="label-cell label-sub">Sost. MATTINA</td>`;
            for (let d = 1; d <= 31; d++) block += (d <= daysInMonth) ? `<td></td>` : `<td class="invalid-day"></td>`;
            block += `</tr>`;
            
            block += `<tr class="row-sost-p"><td class="label-cell label-sub">Sost. POMERIGGIO</td>`;
            for (let d = 1; d <= 31; d++) block += (d <= daysInMonth) ? `<td></td>` : `<td class="invalid-day"></td>`;
            block += `</tr>`;
            
            return block;
        }
    </script>
</body>
</html>
